{"version":3,"sources":["./src/app/bookings/create-booking/create-booking.component.html","./src/app/places/discover/place-detail/place-detail.page.html","./src/app/bookings/create-booking/create-booking.component.scss","./src/app/bookings/create-booking/create-booking.component.ts","./src/app/model/booking.model.ts","./src/app/places/discover/place-detail/place-detail.module.ts","./src/app/places/discover/place-detail/place-detail.page.scss","./src/app/places/discover/place-detail/place-detail.page.ts"],"names":[],"mappings":"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","file":"discover-place-detail-place-detail-module.js","sourcesContent":["export default \"<ion-header>\\n  <ion-toolbar>\\n    <ion-title>Réserver {{ selectedPlace.title }}</ion-title>\\n    <ion-buttons slot=\\\"primary\\\">\\n      <ion-button (click)=\\\"onCancel()\\\">\\n        <ion-icon name=\\\"close\\\"></ion-icon>\\n      </ion-button>\\n    </ion-buttons>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content class=\\\"ion-text-center\\\" padding>\\n  <p>{{ selectedPlace.description }}</p>\\n  <form [formGroup]=\\\"formBooking\\\">\\n    <ion-row>\\n      <ion-col sizeSm=\\\"4\\\" offsetSm=\\\"3\\\">\\n\\n        <ion-item>\\n          <ion-label position=\\\"floating\\\">Nombre de guests</ion-label>\\n          <ion-input formControlName=\\\"guestNumber\\\"  name=\\\"guestNumber\\\" type=\\\"number\\\"></ion-input>\\n        </ion-item>\\n\\n        <ion-item>\\n          <ion-label position=\\\"floating\\\">Date d'arrivée</ion-label>\\n          <ion-datetime formControlName=\\\"startDate\\\"  displayFormat=\\\"D MMM, YY\\\" pickerFormat=\\\"DD MMM YYYY\\\" name=\\\"startDate\\\" [min]=\\\"minStartDate()\\\"></ion-datetime>\\n        </ion-item>\\n\\n        <ion-item>\\n          <ion-label position=\\\"floating\\\">Date de départ</ion-label>\\n          <ion-datetime formControlName=\\\"endDate\\\" displayFormat=\\\"D MMM, YY\\\" pickerFormat=\\\"DD MMM YYYY\\\" name=\\\"endDate\\\" [min]=\\\"minEndDate()\\\"></ion-datetime>\\n        </ion-item>\\n\\n      </ion-col>\\n    </ion-row>\\n  </form>\\n  <ion-button color=\\\"primary\\\" type=\\\"submit\\\" (click)=\\\"onCreateBooking()\\\">Réserver</ion-button>\\n</ion-content>\";","export default \"<ion-header>\\n  <ion-toolbar>\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-back-button defaultHref=\\\"/places/tabs/discover\\\"></ion-back-button>\\n    </ion-buttons>\\n    <ion-title>{{ place.title }}</ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content class=\\\"ion-padding\\\">\\n  <ion-button color=\\\"primary\\\" margin (click)=\\\"onBookPlace()\\\">Réserver</ion-button>\\n</ion-content>\\n\";","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL2Jvb2tpbmdzL2NyZWF0ZS1ib29raW5nL2NyZWF0ZS1ib29raW5nLmNvbXBvbmVudC5zY3NzIn0= */\";","import { Component, OnInit, Input } from '@angular/core';\r\nimport { FormGroup, FormControl, Validators } from '@angular/forms';\r\nimport { ModalController } from '@ionic/angular';\r\nimport { Booking } from 'src/app/model/booking.model';\r\nimport { AuthService } from 'src/app/services/auth/auth.service';\r\nimport { BookingsService } from 'src/app/services/bookings/bookings.service';\r\n\r\nimport { Place } from 'src/app/model/place.model';\r\n\r\n@Component({\r\n  selector: 'app-create-booking',\r\n  templateUrl: './create-booking.component.html',\r\n  styleUrls: ['./create-booking.component.scss']\r\n})\r\nexport class CreateBookingComponent implements OnInit {\r\n  @Input() selectedPlace: Place;\r\n  formBooking: FormGroup;\r\n\r\n  constructor(\r\n    private modalCtrl: ModalController,\r\n    private authService: AuthService,\r\n    private bookingService: BookingsService\r\n  ) { }\r\n\r\n  ngOnInit() { this.generateFormValidation(); }\r\n\r\n  generateFormValidation() {\r\n    this.formBooking = new FormGroup({\r\n      guestNumber: new FormControl(null, { updateOn: 'change', validators: [Validators.required, Validators.min(1)] }),\r\n      startDate: new FormControl(null, { updateOn: 'change', validators: [Validators.required] }),\r\n      endDate: new FormControl(null, { updateOn: 'change', validators: [Validators.required] })\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Create a booking\r\n   */\r\n  onCreateBooking() {\r\n    if (!this.formBooking.valid) { return; }\r\n\r\n    const newBooking = new Booking(\r\n      '0',\r\n      this.selectedPlace.id,\r\n      this.authService.userAuthenticated,\r\n      this.formBooking.value.guestNumber,\r\n      this.formatDate(this.formBooking.value.startDate),\r\n      this.formatDate(this.formBooking.value.endDate)\r\n    );\r\n\r\n    this.bookingService.addBooking(newBooking);\r\n\r\n    this.modalCtrl.dismiss(newBooking, 'confirm');\r\n\r\n  }\r\n\r\n  /**\r\n   * Minimum start date to book\r\n   * @returns \r\n   */\r\n  minStartDate() {\r\n    return this.formatDate(new Date(Date.now()));\r\n  }\r\n\r\n  /**\r\n   * Minimum end date to book\r\n   * @returns \r\n   */\r\n  minEndDate() {\r\n    let date = new Date(this.minStartDate());\r\n    date.setDate(date.getDate() + 1);\r\n    return this.formatDate(date);\r\n  }\r\n\r\n  /**\r\n   * Format date\r\n   * @param date Date to format\r\n   * @returns Formatted date as string\r\n   */\r\n  formatDate(date: Date): string {\r\n    var d = new Date(date),\r\n      month = '' + (d.getMonth() + 1),\r\n      day = '' + d.getDate(),\r\n      year = d.getFullYear();\r\n\r\n    if (month.length < 2)\r\n      month = '0' + month;\r\n    if (day.length < 2)\r\n      day = '0' + day;\r\n\r\n    return [year, month, day].join('-');\r\n  }\r\n\r\n  onCancel() {\r\n    this.modalCtrl.dismiss(null, 'cancel');\r\n  }\r\n}\r\n","export class Booking {\r\n    constructor(\r\n        public id: string,\r\n        public placeId: string,\r\n        public userId: string,\r\n        public guestNumber: number,\r\n        public startDate: string,\r\n        public endDate: string,\r\n    ) { }\r\n}","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { PlaceDetailPage } from './place-detail.page';\nimport { CreateBookingComponent } from '../../../bookings/create-booking/create-booking.component';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: PlaceDetailPage\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    ReactiveFormsModule,\n    IonicModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [PlaceDetailPage, CreateBookingComponent],\n  entryComponents: [CreateBookingComponent]\n})\nexport class PlaceDetailPageModule {}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL3BsYWNlcy9kaXNjb3Zlci9wbGFjZS1kZXRhaWwvcGxhY2UtZGV0YWlsLnBhZ2Uuc2NzcyJ9 */\";","import { Component, OnInit } from '@angular/core';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { NavController, ModalController } from '@ionic/angular';\r\n\r\nimport { CreateBookingComponent } from '../../../bookings/create-booking/create-booking.component';\r\nimport { PlacesService } from 'src/app/services/places/places.service';\r\nimport { Place } from 'src/app/model/place.model';\r\n\r\n@Component({\r\n  selector: 'app-place-detail',\r\n  templateUrl: './place-detail.page.html',\r\n  styleUrls: ['./place-detail.page.scss']\r\n})\r\nexport class PlaceDetailPage implements OnInit {\r\n  place: Place;\r\n\r\n  constructor(\r\n    private navCtrl: NavController,\r\n    private route: ActivatedRoute,\r\n    private placesService: PlacesService,\r\n    private modalCtrl: ModalController\r\n  ) {}\r\n\r\n  ngOnInit() {\r\n    this.route.paramMap.subscribe(paramMap => {\r\n      if (!paramMap.has('placeId')) {\r\n        this.navCtrl.navigateBack('/places/tabs/discover');\r\n        return;\r\n      }\r\n      this.place = this.placesService.getPlaceById(paramMap.get('placeId'));\r\n    });\r\n  }\r\n\r\n  onBookPlace() {\r\n    this.modalCtrl\r\n      .create({\r\n        component: CreateBookingComponent, // modale à créer\r\n        componentProps: { selectedPlace: this.place } // données transmises à la modale\r\n      })\r\n      .then(modalEl => {\r\n        modalEl.present();\r\n        return modalEl.onDidDismiss(); // listener qui renvoie une promesse\r\n      })\r\n      .then(resultData => { // resultData : données transmises par la modale\r\n        console.log(resultData.data, resultData.role);\r\n        if (resultData.role === 'confirm') {\r\n          console.log('BOOKED!');\r\n        }\r\n      });\r\n  }\r\n}\r\n"],"sourceRoot":"webpack:///"}