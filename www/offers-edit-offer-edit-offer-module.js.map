{"version":3,"sources":["./src/app/places/offers/edit-offer/edit-offer.page.html","./src/app/places/offers/edit-offer/edit-offer.module.ts","./src/app/places/offers/edit-offer/edit-offer.page.scss","./src/app/places/offers/edit-offer/edit-offer.page.ts"],"names":[],"mappings":"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","file":"offers-edit-offer-edit-offer-module.js","sourcesContent":["export default \"<ion-header>\\n  <ion-toolbar>\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-back-button [defaultHref]=\\\"'/places/tabs/offers/' + place.id\\\"></ion-back-button>\\n    </ion-buttons>\\n    <ion-title>Edit Offer</ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content class=\\\"ion-padding\\\">\\n  <form [formGroup]=\\\"formOffer\\\">\\n    <ion-grid>\\n      <ion-row>\\n        <ion-col size-sm=\\\"6\\\" offset-sm=\\\"4\\\">\\n          <ion-item>\\n            <ion-label position=\\\"floating\\\">Titre (min 5, max 50)</ion-label>\\n            <ion-input [(ngModel)]=\\\"place.title\\\" type=\\\"text\\\" autocomplete autocorrect formControlName=\\\"title\\\"></ion-input>\\n          </ion-item>\\n        </ion-col>\\n      </ion-row>\\n\\n      <ion-row>\\n        <ion-col size-sm=\\\"6\\\" offset-sm=\\\"4\\\">\\n          <ion-item>\\n            <ion-label position=\\\"floating\\\">Description(min 5, max 255)</ion-label>\\n            <ion-input [(ngModel)]=\\\"place.description\\\" type=\\\"text\\\" autocomplete autocorrect formControlName=\\\"description\\\"></ion-input>\\n          </ion-item>\\n        </ion-col>\\n      </ion-row>\\n\\n      <ion-row>\\n        <ion-col size-sm=\\\"6\\\" offset-sm=\\\"4\\\">\\n          <ion-item>\\n            <ion-label position=\\\"floating\\\">Image</ion-label>\\n            <ion-button color=\\\"primary\\\" (click)=\\\"onAddPicture('library')\\\" full>\\n              <ion-icon name=\\\"image\\\" slot=\\\"icon-only\\\"></ion-icon>\\n              Choisir dans la bibliothèque\\n            </ion-button>\\n\\n            <ion-button color=\\\"primary\\\" (click)=\\\"onAddPicture('camera')\\\" full>\\n              <ion-icon name=\\\"camera\\\" slot=\\\"icon-only\\\"></ion-icon>\\n              Prendre une photo\\n            </ion-button>\\n\\n            <ion-img [src]=\\\"place.image\\\"></ion-img>\\n          </ion-item>\\n        </ion-col>\\n      </ion-row>\\n\\n      <ion-row>\\n        <ion-col size-sm=\\\"6\\\" offset-sm=\\\"4\\\">\\n          <ion-item>\\n            <ion-label position=\\\"floating\\\">Prix (00.00)</ion-label>\\n            <ion-input [(ngModel)]=\\\"place.price\\\" type=\\\"number\\\" autocomplete autocorrect formControlName=\\\"price\\\" step=\\\".01\\\">\\n            </ion-input>\\n          </ion-item>\\n        </ion-col>\\n      </ion-row>\\n      <ion-row>\\n        <ion-col size-sm=\\\"2\\\" offset-sm=\\\"5\\\">\\n          <ion-button color=\\\"primary\\\" type=\\\"submit\\\" (click)=\\\"onUpdateOffer()\\\">Submit\\n          </ion-button>\\n        </ion-col>\\n      </ion-row>\\n    </ion-grid>\\n  </form>\\n</ion-content>\";","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { EditOfferPage } from './edit-offer.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: EditOfferPage\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    ReactiveFormsModule,\n    IonicModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [EditOfferPage]\n})\nexport class EditOfferPageModule { }\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL3BsYWNlcy9vZmZlcnMvZWRpdC1vZmZlci9lZGl0LW9mZmVyLnBhZ2Uuc2NzcyJ9 */\";","import { Component, OnInit } from '@angular/core';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { NavController } from '@ionic/angular';\r\nimport { PlacesService } from 'src/app/services/places/places.service';\r\n\r\nimport { Place } from 'src/app/model/place.model';\r\nimport { AuthService } from 'src/app/services/auth/auth.service';\r\nimport { PhotoService } from 'src/app/services/photo/photo.service';\r\nimport { FormGroup, FormControl, Validators } from '@angular/forms';\r\n\r\n@Component({\r\n  selector: 'app-edit-offer',\r\n  templateUrl: './edit-offer.page.html',\r\n  styleUrls: ['./edit-offer.page.scss']\r\n})\r\nexport class EditOfferPage implements OnInit {\r\n  place: Place;\r\n  image = '';\r\n  formOffer: FormGroup;\r\n\r\n  constructor(\r\n    private photoService: PhotoService,\r\n    private placesService: PlacesService,\r\n    private authService: AuthService,\r\n    private router: Router,\r\n    private route: ActivatedRoute,\r\n    private navCtrl: NavController\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    this.route.paramMap.subscribe(paramMap => {\r\n      if (!paramMap.has('placeId')) {\r\n        this.navCtrl.navigateBack('/places/tabs/offers');\r\n        return;\r\n      }\r\n      this.place = this.placesService.getPlaceById(paramMap.get('placeId'));\r\n    });\r\n    this.generateValidators();\r\n    this.image = this.place.image;\r\n  }\r\n\r\n  generateValidators() {\r\n    this.formOffer = new FormGroup({\r\n      title: new FormControl(null, {\r\n        updateOn: 'change',\r\n        validators: [Validators.required, Validators.minLength(5), Validators.maxLength(50)]\r\n      }),\r\n      description: new FormControl(null, {\r\n        updateOn: 'change',\r\n        validators: [Validators.required, Validators.minLength(5), Validators.maxLength(255)]\r\n      }),\r\n      price: new FormControl(null, {\r\n        updateOn: 'change',\r\n        validators: [Validators.required, Validators.min(0)]\r\n      })\r\n    });\r\n  }\r\n\r\n  /**\r\n  * Méthode pour upload une photo\r\n  * @param source (string) : source de la photo\r\n  */\r\n  onAddPicture(source: String) {\r\n    if (source === 'camera') {\r\n      this.photoService.takePicture().then(imageData => {\r\n        this.place.image = 'data:image/jpeg;base64,' + imageData;\r\n        this.formOffer.patchValue({ image: this.place.image }); // Image in form input\r\n      });\r\n    } else {\r\n      this.photoService.uploadPicture().then(imageData => {\r\n        this.place.image = 'data:image/jpeg;base64,' + imageData;\r\n        this.formOffer.patchValue({ image: this.place.image }); // Image in form input\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Méthode pour update offre\r\n   */\r\n  onUpdateOffer() {\r\n    if (!this.formOffer.valid) { return; }\r\n\r\n    const newPlace = new Place(\r\n      this.place.id,\r\n      this.authService.userAuthenticated,\r\n      this.formOffer.value.title,\r\n      this.formOffer.value.description,\r\n      this.image,\r\n      this.formOffer.value.price);\r\n\r\n    this.placesService.updatePlace(newPlace);\r\n\r\n    this.router.navigate(['/places/tabs/offers']);\r\n  }\r\n\r\n\r\n}\r\n"],"sourceRoot":"webpack:///"}